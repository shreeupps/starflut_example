version: 2
jobs:
  build:
    docker:
      - image: cirrusci/flutter
    steps:
    # - checkout
    # - run: flutter doctor
    #  - run: flutter test 
    #  - run: flutter -v build apk
    - checkout
    - restore_cache:
        key: 1-gems-{{ checksum "Gemfile.lock" }}
    - run: bundle check || bundle install --path vendor/bundle
    - save_cache:
        key: 1-gems-{{ checksum "Gemfile.lock" }}
        paths:vendor/bundle
    - run: bundle exec fastlane $FASTLANE_LANE
          #name: fastlane
          #command: bundle exec fastlane $FASTLANE_LANE
    - store_artifacts:
        path: output
    - store_test_results:
        path: output/scan
